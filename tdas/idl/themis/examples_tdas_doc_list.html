<!-- This file was generated by mk_html_help.pro -->
<html>
 
<head>
<TITLE>themis/examples</TITLE>
</head>
 
<body>
<P>
This page was created by the IDL library routine 
<CODE>mk_html_help2</CODE>.
<br>
<P>
<STRONG>Last modified: </STRONG>Wed Apr 14 11:49:06 2010.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>Directory Listing of Routines</H1></A>
<UL>
<H1>themis/examples</H1>
<LI><A HREF="#THM_CRIB_ASI">THM_CRIB_ASI</A>
<LI><A HREF="#THM_CRIB_CALC">THM_CRIB_CALC</A>
<LI><A HREF="#THM_CRIB_EFI">THM_CRIB_EFI</A>
<LI><A HREF="#THM_CRIB_ESA_READ_GMOMS">THM_CRIB_ESA_READ_GMOMS</A>
<br>This crib shows how to extract the ground-based moments from level 2
<LI><A HREF="#THM_CRIB_ESA_SLICE2D">THM_CRIB_ESA_SLICE2D</A>
<LI><A HREF="#THM_CRIB_EXPORT">THM_CRIB_EXPORT</A>
<LI><A HREF="#THM_CRIB_FAC">THM_CRIB_FAC</A>
<LI><A HREF="#THM_CRIB_FBK">THM_CRIB_FBK</A>
<LI><A HREF="#THM_CRIB_FFT">THM_CRIB_FFT</A>
<LI><A HREF="#THM_CRIB_FGM">THM_CRIB_FGM</A>
<LI><A HREF="#THM_CRIB_FIT">THM_CRIB_FIT</A>
<LI><A HREF="#THM_CRIB_GMAG">THM_CRIB_GMAG</A>
<LI><A HREF="#THM_CRIB_MAKE_AE">THM_CRIB_MAKE_AE</A>
<LI><A HREF="#THM_CRIB_MOM">THM_CRIB_MOM</A>
<LI><A HREF="#THM_CRIB_MVA">THM_CRIB_MVA</A>
<LI><A HREF="#THM_CRIB_OVERPLOT">THM_CRIB_OVERPLOT</A>
<LI><A HREF="#THM_CRIB_PART_GETSPEC">THM_CRIB_PART_GETSPEC</A>
<br>A crib showing how to create energy and angular spectrograms using
<LI><A HREF="#THM_CRIB_PART_SLICE2D">THM_CRIB_PART_SLICE2D</A>
<LI><A HREF="#THM_CRIB_PLOTXY">THM_CRIB_PLOTXY</A>
<LI><A HREF="#THM_CRIB_PLOTXYVEC">THM_CRIB_PLOTXYVEC</A>
<LI><A HREF="#THM_CRIB_PLOTXYZ">THM_CRIB_PLOTXYZ</A>
<LI><A HREF="#THM_CRIB_SCM">THM_CRIB_SCM</A>
<LI><A HREF="#THM_CRIB_SLP_SSE">THM_CRIB_SLP_SSE</A>
<LI><A HREF="#THM_CRIB_SPINFIT">THM_CRIB_SPINFIT</A>
<LI><A HREF="#THM_CRIB_SST">THM_CRIB_SST</A>
<LI><A HREF="#THM_CRIB_SST_CONTAMINATION">THM_CRIB_SST_CONTAMINATION</A>
<LI><A HREF="#THM_CRIB_STATE">THM_CRIB_STATE</A>
<LI><A HREF="#THM_CRIB_TPLOT_OVERLAY">THM_CRIB_TPLOT_OVERLAY</A>
<br>A crib showing how to overlay spectra on top of spectra.
<LI><A HREF="#THM_CRIB_TPLOTXY">THM_CRIB_TPLOTXY</A>
<LI><A HREF="#THM_CRIB_TRACE">THM_CRIB_TRACE</A>
<LI><A HREF="#THM_CRIB_TWAVPOL">THM_CRIB_TWAVPOL</A>
<LI><A HREF="#THM_FGM_FIT_CORRELATE_TPLOT.PRO">THM_FGM_FIT_CORRELATE_TPLOT.PRO
</A>
<br>
</UL><P>
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="THM_CRIB_ASI">
<H2>THM_CRIB_ASI</H2></A>
<A HREF="#THM_CRIB_CALC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
thm_crib_asi.pro
usage:
 .run thm_crib_asi


Written by Harald Frey
 $LastChangedBy: kenb-win2000 $
 $LastChangedDate: 2007-02-11 21:26:08 -0500 (Sun, 11 Feb 2007) $
 $LastChangedRevision: 379 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/trunk/idl/themis/examples/thm_crib_asi.pro $

</PRE><P>
<STRONG>(See <A href="examples/thm_crib_asi.pro">themis/examples/thm_crib_asi.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_CALC">
<H2>THM_CRIB_CALC</H2></A>
<A HREF="#THM_CRIB_ASI">[Previous Routine]</A>
<A HREF="#THM_CRIB_EFI">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
procedure:  thm_crib_calc.pro

purpose: demonstrate how to use the mini-language program 'calc'

usage:
 .run thm_crib_fgm


 $LastChangedBy: pcruce $
 $LastChangedDate: 2008-09-15 17:05:42 -0700 (Mon, 15 Sep 2008) $
 $LastChangedRevision: 3501 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_calc.pro $

</PRE><P>
<STRONG>(See <A href="examples/thm_crib_calc.pro">themis/examples/thm_crib_calc.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_EFI">
<H2>THM_CRIB_EFI</H2></A>
<A HREF="#THM_CRIB_CALC">[Previous Routine]</A>
<A HREF="#THM_CRIB_ESA_READ_GMOMS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
	Batch File: THM_CRIB_EFI

	Purpose:  Demonstrate the loading, calibration, and plotting
		of THEMIS EFI data.

	Calling Sequence:
	.run thm_crib_fbk, or using cut-and-paste.

	Arguements:
   None.

	Notes:
               ***WARNING: Running THM_CRIB_EFI (or likely just calling THM_LOAD_EFI) after THM_CRIB_CLEANEFW will result in the wrong plot labels.
                           The problem is probably in the way that some of the LASP code handles, or does not handle, the TPLOT labelling.
	None.

 $LastChangedBy: mfeuerstein $
 $LastChangedDate: 2009-08-26 17:06:41 -0700 (Wed, 26 Aug 2009) $
 $LastChangedRevision: 6642 $
 $URL $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_efi.pro">themis/examples/thm_crib_efi.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_ESA_READ_GMOMS">
<H2>THM_CRIB_ESA_READ_GMOMS</H2></A>
<A HREF="#THM_CRIB_EFI">[Previous Routine]</A>
<A HREF="#THM_CRIB_ESA_SLICE2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
 thm_crib_esa_read_gmoms
PURPOSE:
This crib shows how to extract the ground-based moments from level 2
ESA data files

Note on variable/routine names: Particle variables/routines follow
the naming convention th[a/b/c/d/e]_p[e/s][i/e][f/r/b] where
th=themis, [a/b/c/d/e]=spacecraft, p=particle, [e/s]=ESA or SST
instrument, [i/e]=ion/electron, [f/r/b]=full/reduced/burst
distribution

 3-dec-2007, jmm, jimm@ssl.berkeley.edu
 $LastChangedBy: jimm $
 $LastChangedDate: 2007-12-03 17:40:09 -0800 (Mon, 03 Dec 2007) $
 $LastChangedRevision: 2139 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_esa_read_gmoms.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_esa_read_gmoms.pro">themis/examples/thm_crib_esa_read_gmoms.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_ESA_SLICE2D">
<H2>THM_CRIB_ESA_SLICE2D</H2></A>
<A HREF="#THM_CRIB_ESA_READ_GMOMS">[Previous Routine]</A>
<A HREF="#THM_CRIB_EXPORT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
Procedure: thm_crib_esa_slice2d

Propose:   Example to call the pro file of thm_esa_slice2d. PNG or PS files of ESA (ion or
           electron) Distribution Functions for the spacecraft (sc) and the type of data (full, reduced
           or burst) would be automatically printed, and the output file would be a 2-D slice of the
           3-D distribution function. The detailed slice properties (such as the definition of x and y
           axis, the two limits of the slice, etc) can be found in thm_esa_slice2d.

Remarks:   You can select a start time and an end time to produce a set of distribution function plots
           with the time increments (specified by INCREMENT) no less than 3 seconds. For each plot, it
           is allowed to have a longer interval than 3 seconds (specified by TIMEINTERVAL) with the
           distribution function being averaged during the whole time interval. Also you need to designate
           the folder (specified by OUTPUTFOLDER) that you wish to put the output files.

LAST EDITED BY XUZHI ZHOU 4-24-2008
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_esa_slice2d.pro">themis/examples/thm_crib_esa_slice2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_EXPORT">
<H2>THM_CRIB_EXPORT</H2></A>
<A HREF="#THM_CRIB_ESA_SLICE2D">[Previous Routine]</A>
<A HREF="#THM_CRIB_FAC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
	Batch File: THM_CRIB_EXPORT

	Purpose:  Demonstrate tplot export functions

	Calling Sequence:
	.run thm_crib_export, or using cut-and-paste.

	Arguements:
   None.

	Notes:
	None.

 $LastChangedBy: jimm $
 $LastChangedDate: 2010-04-07 14:44:00 -0700 (Wed, 07 Apr 2010) $
 $LastChangedRevision: 7468 $
 $URL $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_export.pro">themis/examples/thm_crib_export.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_FAC">
<H2>THM_CRIB_FAC</H2></A>
<A HREF="#THM_CRIB_EXPORT">[Previous Routine]</A>
<A HREF="#THM_CRIB_FBK">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
Procedure: thm_crib_fac

Purpose:  A crib on showing how to transform into field aligned coordinates DSL coordinates

Notes:

 $LastChangedBy: jimm $
 $LastChangedDate: 2010-04-07 14:44:00 -0700 (Wed, 07 Apr 2010) $
 $LastChangedRevision: 7468 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_fac.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_fac.pro">themis/examples/thm_crib_fac.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_FBK">
<H2>THM_CRIB_FBK</H2></A>
<A HREF="#THM_CRIB_FAC">[Previous Routine]</A>
<A HREF="#THM_CRIB_FFT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
	Batch File: THM_CRIB_FBK

	Purpose:  Demonstrate the loading, calibration, and plotting
		of THEMIS FBK (Filter Bank) spectral data.

	Calling Sequence:
	.run thm_crib_fbk, or using cut-and-paste.

	Arguements:
   None.

	Notes:
	None.

 $LastChangedBy: kenb-mac $
 $LastChangedDate: 2007-08-01 22:11:55 -0700 (Wed, 01 Aug 2007) $
 $LastChangedRevision: 1319 $
 $URL $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_fbk.pro">themis/examples/thm_crib_fbk.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_FFT">
<H2>THM_CRIB_FFT</H2></A>
<A HREF="#THM_CRIB_FBK">[Previous Routine]</A>
<A HREF="#THM_CRIB_FGM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
	Batch File: THM_CRIB_FFT

	Purpose:  Demonstrate the loading, calibration, and plotting
		of THEMIS FFT spectra (ParticleBurst and WaveBurst) data

	Calling Sequence:
	.run thm_crib_fft, or using cut-and-paste.

	Arguements:
   None.

	Notes:
	None.

Written by Patrick Cruce(with liberal copying from thm_crib_fit.pro)
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_fft.pro">themis/examples/thm_crib_fft.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_FGM">
<H2>THM_CRIB_FGM</H2></A>
<A HREF="#THM_CRIB_FFT">[Previous Routine]</A>
<A HREF="#THM_CRIB_FIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
thm_crib_fgm.pro
usage:
 .run thm_crib_fgm


Written by Hannes Schwarzl and Ken Bromund
 $LastChangedBy: jimm $
 $LastChangedDate: 2010-04-07 14:44:00 -0700 (Wed, 07 Apr 2010) $
 $LastChangedRevision: 7468 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_fgm.pro $

</PRE><P>
<STRONG>(See <A href="examples/thm_crib_fgm.pro">themis/examples/thm_crib_fgm.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_FIT">
<H2>THM_CRIB_FIT</H2></A>
<A HREF="#THM_CRIB_FGM">[Previous Routine]</A>
<A HREF="#THM_CRIB_GMAG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
	Batch File: THM_CRIB_FIT

	Purpose:  Demonstrate the loading, calibration, and plotting
		of THEMIS FIT (On-Board E- and B-Field SpinFit) data.

	Calling Sequence:
	.run thm_crib_fit, or using cut-and-paste.

	Arguements:
   None.

	Notes:
	None.

Written by John Bonnell
 $LastChangedBy: jimm $
 $LastChangedDate: 2010-04-07 14:44:00 -0700 (Wed, 07 Apr 2010) $
 $LastChangedRevision: 7468 $
 $URL $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_fit.pro">themis/examples/thm_crib_fit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_GMAG">
<H2>THM_CRIB_GMAG</H2></A>
<A HREF="#THM_CRIB_FIT">[Previous Routine]</A>
<A HREF="#THM_CRIB_MAKE_AE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
pro thm_crib_gmag
 This is an example crib sheet that will load ground mag data.
 Open this file in a text editor and then use copy and paste to copy
 selected lines into an idl window. Or alternatively compile and run
 using the command:
 .RUN THM_CRIB_GMAG
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_gmag.pro">themis/examples/thm_crib_gmag.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_MAKE_AE">
<H2>THM_CRIB_MAKE_AE</H2></A>
<A HREF="#THM_CRIB_GMAG">[Previous Routine]</A>
<A HREF="#THM_CRIB_MOM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
pro thm_crib_make_AE

 This is an example crib sheet that will calculate and plot &quot;pseudo&quot; geomagnetic
 indices (thmAE, thmAU, thmAL) as derived from THEMIS ground magnetometer data.
 In future, it is planned to include ground magnetometer data from other magnetometer
 networks. Note that currently the calculation of these &quot;pseudo&quot; indices does not
 subtract quiet day variation but simply the median.

 Open this file in a text editor and then use copy and paste to copy
 selected lines into an idl window.


 Written by Andreas Keiling, 15 May 2008

 Modifications:
   Changed name from thm_crib_AE to thm_crib_make_AE, added print info/stops,
     remove DEL_DATA,'*' command, W.M.Feuerstein, 6/2/2008.

 $LastChangedBy: jimm $
 $LastChangedDate: 2009-02-06 13:01:05 -0800 (Fri, 06 Feb 2009) $
 $LastChangedRevision: 4910 $
 $URL $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_make_ae.pro">themis/examples/thm_crib_make_ae.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_MOM">
<H2>THM_CRIB_MOM</H2></A>
<A HREF="#THM_CRIB_MAKE_AE">[Previous Routine]</A>
<A HREF="#THM_CRIB_MVA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
pro thm_crib_mom
 This is an example crib sheet that will load onboard MOMent data.
 It also shows how to compute moments from the full distributions.
 Data is corrected for spacecraft potential.

 Open this file in a text editor and then use copy and paste to copy
 selected lines into an idl window. Or alternatively compile and run
 using the command:
 .RUN THM_CRIB_MOM
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_mom.pro">themis/examples/thm_crib_mom.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_MVA">
<H2>THM_CRIB_MVA</H2></A>
<A HREF="#THM_CRIB_MOM">[Previous Routine]</A>
<A HREF="#THM_CRIB_OVERPLOT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
Procedure: thm_crib_mva

Purpose:  A crib on showing how to transform into minimum variance
analysis coordinates

Notes:

 $LastChangedBy: jimm $
 $LastChangedDate: 2010-04-07 14:44:00 -0700 (Wed, 07 Apr 2010) $
 $LastChangedRevision: 7468 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_mva.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_mva.pro">themis/examples/thm_crib_mva.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_OVERPLOT">
<H2>THM_CRIB_OVERPLOT</H2></A>
<A HREF="#THM_CRIB_MVA">[Previous Routine]</A>
<A HREF="#THM_CRIB_PART_GETSPEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: thm_crib_overplot

 PURPOSE: this crib describes how to generate overview plots
          if there are any arguments or features for these 
          procedures you would like to request, please feel 
          free to ask.

 $LastChangedBy: pcruce $
 $LastChangedDate: 2008-01-30 12:39:05 -0800 (Wed, 30 Jan 2008) $
 $LastChangedRevision: 2328 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_overplot.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_overplot.pro">themis/examples/thm_crib_overplot.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_PART_GETSPEC">
<H2>THM_CRIB_PART_GETSPEC</H2></A>
<A HREF="#THM_CRIB_OVERPLOT">[Previous Routine]</A>
<A HREF="#THM_CRIB_PART_SLICE2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE: thm_crib_part_getspec

  ***** A copy and paste crib *****

PURPOSE:
  A crib showing how to create energy and angular spectrograms using
  THM_PART_GETSPEC.

DETAILS
  THM_PART_GETSPEC is a wrapper that takes user input and creates tplot
  variables containing energy and/or angular spectra of ESA and SST data. The
  tplot variables created end in 'en_eflux' for energy spectra and 'an_eflux'
  plus a suffix corresponding to the type of angular spectrum specified by
  the ANGLE keyword for angular spectra by default. The user can select a
  range of probe(s), PROBE, and time range, TRANGE, of interest. The energy
  range of interest, ERANGE, is specified in eV. The user can also choose to
  create tplot variable for one or more data types, DATA_TYPE. The phi, PHI,
  and theta, THETA, ranges of interest, specified in DSL coordinates, can also
  be input, by the user. SUFFIX specifies a string that will be added to the
  *an_eflux*' tplot variables.

  If the phi range is greater than 360 degrees, then the phi bins at the
  beginning of the phi range are added and wrapped around the end of phi
  range. For example, if phi=[0,420], the phi bins corresponding to 0-60
  degrees are appended to the top of the plot.

  The START_ANGLE keyword specifies the start of the y-axis (phi). This is
  useful to center the spectra plot on the y-axis at a particular phi angle.
  If this keyword is not set, the y-axis starts at the first angle input to
  the PHI keyword.

  Use the ENERGY and ANGLE keywords to specify whether to create tplot
  variables for energy and/or angular spectra. The ANGLE keyword is also used
  to specify the type of angular spectrum created (e.g. phi, theta, pa, gyro).
  If neither of ENERGY and ANGLE keywords are specified, then both are turned
  on and the angular spectrum type defaults to phi.

  When set, the AUTOPLOT keyword enables to the tplot variables to be
  automatically plotted using some simple code located at the end of
  THM_PART_GETSPEC. The tplot variables created are properly formatted by
  THM_PART_MOMENTS2 and THM_PART_GETSPEC whether or not AUTOPLOT is set.
  Setting AUTOPLOT will also create a default tplot title containing the
  theta, phi, and energy ranges used to create the plot.

  After reading in the user's input, THM_PART_GETSPEC then calls THM_LOAD_SST
  and/or THM_LOAD_ESA_PKT to load the particle data.  THM_PART_MOMENTS2 is
  then called to format the spectra data based on the user's input and create
  the tplot variables.  THM_PART_MOMENTS2 calls THM_PART_GETANBINS in order to
  determine which energy/angle bins should be turned on/off. If there's a mode
  change, THM_PART_MOMENTS2 will re-call THM_PART_GETANBINS to account for any
  changes in the mode's anglemap.

  Pitch angle (ANGLE='pa') and gyrovelocity (ANGLE='gyro') spectra are generated
  by gridding a globe in a field-aligned coordinate (FAC) system at regular
  intervals along pitch (latitude) and gyrovelocity (longitude) as specified by
  the REGRID keyword. These FAC angle bins are then rotated back into the
  native DSL coordinates of the particle distribution data. The flux assigned
  to a given FAC angle bin is determined by native angle bin to which the center
  of FAC angle bin has been rotated. So if a FAC angle bin center is rotated
  into the 88th angle bin of the probe's particle distribution data, the flux
  for that FAC angle bin is the same as the flux in angle bin 88 of the
  particle distribution data. This rotation occurs for each time sample of the
  probe's particle data.

  The size of the FAC system grid is specified with the REGRID = [m,n], a two-
  element array in which the first element of the array specifies the number
  of grid elements in the gyrovelocity (longitudinal) direction while the second
  element sets he number of grid elements in the pitch (latitudinal)
  direction.  Increasing the number of elements in the FAC system grid will
  increase the accuracy of the pitch angle and gyrovelocity angle spectra as it
  decreases the degree to which the FAC bins overlap into one or more native
  distribution angle bin. Suitable numbers for m and n are numbers like 2^k.
  So far, k=2-6 has been tested and work. Other numbers will work provided
  180/n and 360/m are rational.

  The PITCH and GYRO keywords set the angle range of interest for pitch angle
  and gyrovelocity spectra plots similarly to the THETA and PHI keywords.
  Setting PHI and THETA will affect pitch angle and gyrovelocity plot, but the
  PITCH and GYRO keywords will be ignored when the ANGLE keyword is set to
  'PHI' or 'THETA'. Energy spectra, generated by using the /ENERGY keyword, will
  also be affected by PITCH and GYRO settings. 

  The OTHER_DIM keyword specifies the second axis for the field aligned
  coordinate system, necessary when plotting pitch angle or gyrovelocity spectra.
  See THM_FAC_MATRIX_MAKE for more info. If the keyword is not set in
  THM_PART_GETSPEC, OTHER_DIM defaults to 'mphigeo'.

  Also, when calculating pitch angle and/or gyrovelocity spectra
  THM_FAC_MATRIX_MAKE might require the data be de-gapped in order to
  calculate the rotation matrix. If so, the /degap keyword and tdegap keywords
  can passed in the call to THM_PART_GETSPEC.  See TDEGAP and
  THM_FAC_MATRIX_MAKE for more info.

  The /NORMALIZE keyword will normalize the flux for each time sample in a
  spectra plot to values between 0 and 1.
  
  BADBINS2MASK is a 0-1 array that will be mask SST bins with a NaN to
  eliminate artifacts such as sun contamination. The array should have the same
  number of elements as the number of angle bins for a given data type. A 0
  indicates that will be masked with a NaN. This is basically the output from
  the bins argument of EDIT3DBINS.
  
  The DATAGAP is very useful when you want to overlay burst mode spectra plots
  over full mode spectra. Set the DATAGAP keyword to a number of seconds that
  is less than the time gap of the burst data, but greater than the sample
  interval of the underlying full mode data.  This way the time gaps between
  the burst mode data won't be interpolated by SPECPLOT and cover up the full
  mode data between the burst mode data. 


NOTES:
	- All angles are in DSL coordinates
	- All datatypes are now valid
   - Theta input must satisfy: -90 &lt; theta[0] &lt; theta[1] &lt; 90
   - Phi input must be specified in ascending order in degrees
     (e.g. [270, 450] or [-90, 90] to specify the 'daylight' hemisphere in DSL
     coordinates)
   - Incorporates improvements contained in v1.2

CREATED BY:  Bryan Kerr
VERSION: 1.2
  $LastChangedBy: bckerr $
  $LastChangedDate: 2009-01-14 10:15:19 -0800 (Wed, 14 Jan 2009) $
  $LastChangedRevision: 4464 $
  $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_part_getspec.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_part_getspec.pro">themis/examples/thm_crib_part_getspec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_PART_SLICE2D">
<H2>THM_CRIB_PART_SLICE2D</H2></A>
<A HREF="#THM_CRIB_PART_GETSPEC">[Previous Routine]</A>
<A HREF="#THM_CRIB_PLOTXY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
Purpose: A crib showing how to create 2-D slices through Themis particle
         distributions using THM_PART_SLICE2D.PRO.
 
 This is a cut and past crib.
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_part_slice2d.pro">themis/examples/thm_crib_part_slice2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_PLOTXY">
<H2>THM_CRIB_PLOTXY</H2></A>
<A HREF="#THM_CRIB_PART_SLICE2D">[Previous Routine]</A>
<A HREF="#THM_CRIB_PLOTXYVEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: thm_crib_plotxy

 Purpose:crib to demonstrate capabilities of plotxy

 Notes: run it by compiling in idl and then typing &quot;.go&quot;
        or copy and paste.

 $LastChangedBy: pcruce $
 $LastChangedDate: 2008-02-06 13:43:58 -0800 (Wed, 06 Feb 2008) $
 $LastChangedRevision: 2352 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/ssl_general/trunk/tplot/tplotxy.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_plotxy.pro">themis/examples/thm_crib_plotxy.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_PLOTXYVEC">
<H2>THM_CRIB_PLOTXYVEC</H2></A>
<A HREF="#THM_CRIB_PLOTXY">[Previous Routine]</A>
<A HREF="#THM_CRIB_PLOTXYZ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: thm_crib_plotxyvec

 Purpose:crib to demonstrate capabilities of plotxyvec

 Notes: run it by compiling in idl and then typing &quot;.go&quot;
        or copy and paste.

 The options:  hsize,color,hthick,solid, &amp; thick from the arrow
    routine are usable in this routine.

 $LastChangedBy: pcruce $
 $LastChangedDate: 2008-08-04 12:16:47 -0700 (Mon, 04 Aug 2008) $
 $LastChangedRevision: 3337 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_plotxyvec.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_plotxyvec.pro">themis/examples/thm_crib_plotxyvec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_PLOTXYZ">
<H2>THM_CRIB_PLOTXYZ</H2></A>
<A HREF="#THM_CRIB_PLOTXYVEC">[Previous Routine]</A>
<A HREF="#THM_CRIB_SCM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: thm_crib_plotxyz

 Purpose:crib to demonstrate capabilities of plotxyz

 Notes: run it by compiling in idl and then typing &quot;.go&quot;
        or copy and paste.

 SEE ALSO: bin1d.pro,bin2d.pro,plotxyz.pro

 $LastChangedBy: pcruce $
 $LastChangedDate: 2008-02-06 13:43:58 -0800 (Wed, 06 Feb 2008) $
 $LastChangedRevision: 2352 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/ssl_general/trunk/tplot/tplotxy.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_plotxyz.pro">themis/examples/thm_crib_plotxyz.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_SCM">
<H2>THM_CRIB_SCM</H2></A>
<A HREF="#THM_CRIB_PLOTXYZ">[Previous Routine]</A>
<A HREF="#THM_CRIB_SLP_SSE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 **********************************************************************
 thm_crib_scm.pro : IDL batch file to get, clean and calibrate SCM data
  with thm_cal_scm
 K. Bromund
 O. Le Contel &amp; P. Robert, CETP
 **********************************************************************
 $LastChangedBy: kenb-mac $
 $LastChangedDate: 2007-10-02 09:25:57 -0700 (Tue, 02 Oct 2007) $
 $LastChangedRevision: 1646 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_scm.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_scm.pro">themis/examples/thm_crib_scm.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_SLP_SSE">
<H2>THM_CRIB_SLP_SSE</H2></A>
<A HREF="#THM_CRIB_SCM">[Previous Routine]</A>
<A HREF="#THM_CRIB_SPINFIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
  thm_crib_slp_sse

Purpose:
  Crib to demonstrate how to use Solar Lunar Planetary Data,
  And how to perform SSE transformation


 $LastChangedBy: jimm $
 $LastChangedDate: 2010-04-07 14:44:00 -0700 (Wed, 07 Apr 2010) $
 $LastChangedRevision: 7468 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_slp_sse.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_slp_sse.pro">themis/examples/thm_crib_slp_sse.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_SPINFIT">
<H2>THM_CRIB_SPINFIT</H2></A>
<A HREF="#THM_CRIB_SLP_SSE">[Previous Routine]</A>
<A HREF="#THM_CRIB_SST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
	Batch File: THM_SPINFIT

	Purpose:  Demonstration of finding spin fit parameters for spinning data.
   The FIT module calculates the E-Field and B-Field vectors by taking 32 points at equal angles
   and fitting a sine wave least squares fit to the data. The best fit of the data is defined by the
   formula: A + B*cos() + C*sin(). The module calculates the standard deviation of the fit
   called Sigma, and the number of points remaining in the curve called N.

	Calling Sequence:
	  Cut-and-paste the code to the command line.

	Arguments:
   required parameters:
     var_name_in = tplot variable name containing data to fit

   keywords:
    sigma = If set, will cause program to output tplot variable with sigma for each period.
    npoints = If set, will cause program to output tplot variable with number of points in fit.
    spinaxis = If set, program will output a tplot variable storing the average over the spin axis dimension
             for each time period.
    median  = If spinaxis set, program will output a median of each period instead of the average.
    plane_dim = Tells program which dimension to treat as the plane. 0=x, 1=y, 2=z. Default 0.
    axis_dim = Tells program which dimension contains axis to average over. Default 0.  Will not
             create a tplot variable unless used with /spinaxis.
    min_points = Minimum number of points to fit.  Default = 5.
    alpha = A parameter for finding fits.  Points outside of sigma*(alpha + beta*i)
          will be thrown out.  Default 1.4.
    beta = A parameter for finding fits.  See above.  Default = 0.4
    phase_mask_starts = Time to start masking data.  Default = 0
    phase_mask_ends = Time to stop masking data.  Default = -1
    sun2sensor = Tells how much to rotate data to align with sun sensor.


	Notes:
	The module determines which data is more than xN * �N (sN = standard deviation) away from fit,
   and removes those points and repeats the fit. The second time the standard deviation is
   smaller so the tolerance is increased a bit. The tolerance xN varies with try as:
   Alpha*NBeta, where A=1.4 and Beta=0.4 provide good results. The operation continues
   until no points are outside the bounds and the process is considered convergent.

Written by Katherine Ramer
 $LastChangedBy: Katherine Ramer$
 $LastChangedDate: 2010-04-07 14:44:00 -0700 (Wed, 07 Apr 2010) $
 $LastChangedRevision: 7468 $
 $URL $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_spinfit.pro">themis/examples/thm_crib_spinfit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_SST">
<H2>THM_CRIB_SST</H2></A>
<A HREF="#THM_CRIB_SPINFIT">[Previous Routine]</A>
<A HREF="#THM_CRIB_SST_CONTAMINATION">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
pro thm_sst_crib
 This is an example crib sheet that will load Solid State Telescope data.
 Open this file in a text editor and then use copy and paste to copy
 selected lines into an idl window. Or alternatively compile and run
 using the command:
 .RUN THM_SST_CRIB
Author: Davin Larson

Modified: 2007-07-19 by Matt Davis.  This a simplified version of Davin's
		original crib and is intended to demonstrate the very basics of
		loading in the SST energy spectrograms.
		The more comprehensive crib can be found with the SST routines in:
		idl/themis/spacecraft/particles/SST/thm_sst_crib.pro

 $Id: thm_crib_sst.pro 1586 2007-09-18 12:42:50Z davin-win $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_sst.pro">themis/examples/thm_crib_sst.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_SST_CONTAMINATION">
<H2>THM_CRIB_SST_CONTAMINATION</H2></A>
<A HREF="#THM_CRIB_SST">[Previous Routine]</A>
<A HREF="#THM_CRIB_STATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE: thm_crib_sst_contamination
Purpose: 1. Demonstrate the basic procedure for removal of sun contamination,
            electronic noise, and masking.
         2.. Demonstrate removal of suncontamination via various methods.  
         3. Demonstrate the correction of inadvertant masking in SST data
         4. Demonstrate scaling data for loss of solid angle in SST measurements.
         5. Demonstrate substraction of electronic noise by selecting bins in a specific region
         6. Show how to use these techniques for both angular spectrograms,energy spectrgrams, and moments.

SEE ALSO:
  thm_remove_sunpulse.pro(this routine has the majority of the documentation)
  thm_part_moments.pro, thm_part_moments2.pro, thm_part_getspec.pro
  thm_part_dist.pro, thm_sst_psif.pro, thm_sst_psef.pro,thm_sst_erange_bin_val.pro
  thm_crib_part_getspec.pro

 $LastChangedBy: pcruce $
 $LastChangedDate: 2009-05-29 12:03:56 -0700 (Fri, 29 May 2009) $
 $LastChangedRevision: 5996 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_sst_contamination.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_sst_contamination.pro">themis/examples/thm_crib_sst_contamination.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_STATE">
<H2>THM_CRIB_STATE</H2></A>
<A HREF="#THM_CRIB_SST_CONTAMINATION">[Previous Routine]</A>
<A HREF="#THM_CRIB_TPLOTXY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
	Batch File: THM_CRIB_STATE

	Purpose:  Demonstrate the loading, coordinate transformation,
	plotting and labeling with state data

	Calling Sequence:
	.run thm_crib_state, or using cut-and-paste.

	Arguements:
   None.

	Notes:
	None.

 $LastChangedBy: jimm $
 $LastChangedDate: 2010-04-07 14:44:00 -0700 (Wed, 07 Apr 2010) $
 $LastChangedRevision: 7468 $
 $URL $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_state.pro">themis/examples/thm_crib_state.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_TPLOTXY">
<H2>THM_CRIB_TPLOTXY</H2></A>
<A HREF="#THM_CRIB_STATE">[Previous Routine]</A>
<A HREF="#THM_CRIB_TPLOT_OVERLAY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: thm_crib_tplotxy

 Purpose:crib to demonstrate capabilities of tplotxy

 Notes: run it by compiling in idl and then typing &quot;.go&quot;
        or copy and paste.

 $LastChangedBy: pcruce $
 $LastChangedDate: 2008-02-06 13:43:58 -0800 (Wed, 06 Feb 2008) $
 $LastChangedRevision: 2352 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/ssl_general/trunk/tplot/tplotxy.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_tplotxy.pro">themis/examples/thm_crib_tplotxy.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_TPLOT_OVERLAY">
<H2>THM_CRIB_TPLOT_OVERLAY</H2></A>
<A HREF="#THM_CRIB_TPLOTXY">[Previous Routine]</A>
<A HREF="#THM_CRIB_TRACE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE: thm_crib_tplot_overlay

  ***** A copy and paste crib *****

PURPOSE:
  A crib showing how to overlay spectra on top of spectra.

DETAILS
  This crib shows how to combine full and burst mode spectra into one plot by
  overlaying the burst mode data on top of the full mode data.

  The DATAGAP keyword is very useful when you want to overlay burst mode
  spectra plots over full mode spectra. Set the DATAGAP keyword to a number
  of seconds that is less than the time gap of the burst data, but greater than
  the sample interval of the underlying full mode data.  This way the time gaps
  between the burst mode data won't be interpolated by SPECPLOT and cover up
  the full mode data between the burst mode data. 


CREATED BY:  Bryan Kerr

</PRE><P>
<STRONG>(See <A href="examples/thm_crib_tplot_overlay.pro">themis/examples/thm_crib_tplot_overlay.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_TRACE">
<H2>THM_CRIB_TRACE</H2></A>
<A HREF="#THM_CRIB_TPLOT_OVERLAY">[Previous Routine]</A>
<A HREF="#THM_CRIB_TWAVPOL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Name: thm_crib_trace

 Purpose:crib to demonstrate use of Tsyaganenko trace routines, and means for generating plots of trace routines.

 Notes: 1. run it by compiling in idl and then typing &quot;.go&quot;
        or copy and paste.  If you want, you can just edit the parameters for the
        routine and run it as is.
        
        2. There are commented sections, to do things like plot positions of groundstations and other spacecraft, or use other fields model.
           Just uncomment these sections to enable the desired behavior

 SEE ALSO: idl/external/IDL_GEOPACK/trace/ttrace_crib.pro
           idl/ssl_general/cotrans/aacgm/aacgm_example.pro
           idl/themis/examples/thm_crib_tplotxy.pro

 $LastChangedBy: pcruce $
 $LastChangedDate: 2009-08-12 11:36:52 -0700 (Wed, 12 Aug 2009) $
 $LastChangedRevision: 6564 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/thmsoc/tags/tdas_5_21/idl/themis/examples/thm_crib_trace.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_trace.pro">themis/examples/thm_crib_trace.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_CRIB_TWAVPOL">
<H2>THM_CRIB_TWAVPOL</H2></A>
<A HREF="#THM_CRIB_TRACE">[Previous Routine]</A>
<A HREF="#THM_FGM_FIT_CORRELATE_TPLOT.PRO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 **********************************************************************
 thm_crib_twavpol.pro : with twavpol.pro
 **********************************************************************
This version stores these outputs as tplot variables with the
specified prefix
         These are follows:

         Wave power: On a linear scale, at this stage no units

         Degree of Polarisation:
		This is similar to a measure of coherency between the input
		signals, however unlike coherency it is invariant under
		coordinate transformation and can detect pure state waves
		which may exist in one channel only.100% indicates a pure
		state wave. Less than 70% indicates noise. For more
		information see J. C. Samson and J. V. Olson 'Some comments
		on the description of the polarization states
		of waves' Geophys. J. R. Astr. Soc. (1980) v61 115-130

         Wavenormal Angle:
		the angle between the direction of minimum
		variance calculated from the complex off diagonal
		elements of the spectral matrix and the Z direction
		of the input
		ac field data. For magnetic field data in
		field aligned coordinates this is the
		wavenormal angle assuming a plane wave.

         Ellipticity:The ratio (minor axis)/(major axis) of the
		ellipse transcribed by the field variations of the
		components transverse to the Z direction. The sign
		indicates the direction of rotation of the field vector in
  		the plane. Negative signs refer to left-handed
		rotation about the Z direction. In the field
		aligned coordinate system these signs refer to
		plasma waves of left and right handed
		polarisation.

         Helicity:Similar to Ellipticity except defined in terms of the
	direction of minimum variance instead of Z. Stricltly the Helicity
	is defined in terms of the wavenormal direction or k.
	However since from single point observations the
	sense of k cannot be determined,  helicity here is
	simply the ratio of the minor to major axis transverse to the
       minimum variance direction without sign.


Written by : Kaori(I'll remember to get her last name soon)


 $LastChangedBy: pcruce $
 $LastChangedDate: 2007-12-06 14:56:54 -0800 (Thu, 06 Dec 2007) $
 $LastChangedRevision: 2161 $
 $URL: svn+ssh://thmsvn@ambrosia.ssl.berkeley.edu/repos/ssl_general/trunk/misc/tplotxy.pro $
</PRE><P>
<STRONG>(See <A href="examples/thm_crib_twavpol.pro">themis/examples/thm_crib_twavpol.pro</A>)</STRONG><P>
<HR>
 
<A NAME="THM_FGM_FIT_CORRELATE_TPLOT.PRO">
<H2>THM_FGM_FIT_CORRELATE_TPLOT.PRO</H2></A>
<A HREF="#THM_CRIB_TWAVPOL">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       thm_fgm_fit_correlate_tplot.pro

 Purpose:
       Uses ssl_correlation_shift.pro to do a correlation shift
       analysis on the vector lengths(math not cs vectors) of a
       selected fgm mnemonic and fit data


 CATEGORY:
       THEMIS-SOC
 CALLING SEQUENCE:
      pro thm_fgm_fit_correlate_tplot,fit_name, fgm_name, store_name, correlation_floor = correlation_floor, point_number =  point_number, lag_step_number = lag_step_number, time_step_size = time_step_size, bin_size = bin_size

 INPUTS:
 
       fit_name: the tplot name of the fit data to be compared. RAW
       LEVEL 1 FIT DATA IS REQUIRED, E.G., 'tha_fit'
      
       fgm_name: the tplot name of the fgm_data to be
       compared

       store_name: the name of a tplot variable in which to store the result
     
       correlation_floor: optional, if set filters all results where
       the correlation between functions is too poor(default:0.0)

       point_number: optional, the minimum number of points of
       overlap necessary to try correlating a bin(default:10)

       lag_step_number: optional, checks plus or minus lag_steps * time steps
       to correlate the vectors (default:5)

       time_step_size: optional, the size of the time step to use when
       interpolating and correlating the vectors, in
       seconds(default:1/8 seconds)

       bin_size: optional, the size of each bin in seconds
       (default:60 seconds)
       

 OUTPUTS:
       
       stores the time and the shift values in the selected tplot_var

 KEYWORDS:

 COMMENTS: This function will probably die horribly if time
  values are not monotonic.


 PROCEDURE:

 EXAMPLE:

 MODIFICATION HISTORY:
       Written by: Patrick Cruce(pcruce@gmail.com)
       2007-06-06        V1.0

 KNOWN BUGS: tcs_vector_length doesn't filter NANs so it may output 
 arithmetic warnings
</PRE><P>
<STRONG>(See <A href="examples/thm_fgm_fit_correlate_tplot.pro">themis/examples/thm_fgm_fit_correlate_tplot.pro</A>)</STRONG><P>
<HR>
 
