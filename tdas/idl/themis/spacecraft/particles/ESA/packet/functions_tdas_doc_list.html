<!-- This file was generated by mk_html_help.pro -->
<html>
 
<head>
<TITLE>themis/spacecraft/particles/ESA/packet/functions</TITLE>
</head>
 
<body>
<P>
This page was created by the IDL library routine 
<CODE>mk_html_help2</CODE>.
<br>
<P>
<STRONG>Last modified: </STRONG>Wed Apr 14 11:49:06 2010.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>Directory Listing of Routines</H1></A>
<UL>
<H1>themis/spacecraft/particles/ESA/packet/functions</H1>
<LI><A HREF="#BETA_3D_NEW">BETA_3D_NEW</A>
<br>Returns beta, P/B^2/8pi, corrects for spacecraft potential if dat.sc_pot exists
<LI><A HREF="#ENERGY_TO_EBIN">ENERGY_TO_EBIN</A>
<br>Returns the energy bin numbers in &quot;dat.energy&quot; nearest to &quot;en&quot;
<LI><A HREF="#GET_2DT">GET_2DT</A>
<br>To generate time series data for &quot;tplot.pro&quot;
<LI><A HREF="#GET_EN_SPEC">GET_EN_SPEC</A>
<br>Generates energy-time spectrogram data structures for tplot
<LI><A HREF="#J_3D_NEW">J_3D_NEW</A>
<br>Returns the flux, [Jx,Jy,Jz], 1/(cm^2-s)
<LI><A HREF="#JE_3D_NEW">JE_3D_NEW</A>
<br>Returns the energy flux, [JEx,JEy,JEz], 1/(cm^2-s)
<LI><A HREF="#JE_PAR_3D_NEW">JE_PAR_3D_NEW</A>
<br>Returns the energy flux, [JEx,JEy,JEz], 1/(cm^2-s)
<LI><A HREF="#N_3D_NEW">N_3D_NEW</A>
<br>Returns the density, n, 1/cm^3, corrects for spacecraft potential if dat.sc_pot exists
<LI><A HREF="#P_3D_NEW">P_3D_NEW</A>
<br>Returns the pressure tensor, [Pxx,Pyy,Pzz,Pxy,Pxz,Pyz], eV/cm^3
<LI><A HREF="#T_3D_NEW">T_3D_NEW</A>
<br>Returns the temperature, [Tx,Ty,Tz,Tavg], eV
<LI><A HREF="#V_3D_NEW">V_3D_NEW</A>
<br>Returns the velocity, [Vx,Vy,Vz], km/s
<LI><A HREF="#VPAR_3D_NEW">VPAR_3D_NEW</A>
<br>Returns Vpar, km/s, corrects for spacecraft potential if dat.sc_pot exists
<LI><A HREF="#VPERP_3D_NEW">VPERP_3D_NEW</A>
<br>Returns Vperp, km/s, corrects for spacecraft potential if dat.sc_pot exists
<LI><A HREF="#VXB_3D_NEW">VXB_3D_NEW</A>
<br>Returns VxB, mV/m, corrects for spacecraft potential if dat.sc_pot exists
<br>
</UL><P>
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="BETA_3D_NEW">
<H2>BETA_3D_NEW</H2></A>
<A HREF="#ENERGY_TO_EBIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	beta_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	3d data structure 
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns beta, P/B^2/8pi, corrects for spacecraft potential if dat.sc_pot exists
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to 
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	07-4-29	
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/beta_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/beta_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ENERGY_TO_EBIN">
<H2>ENERGY_TO_EBIN</H2></A>
<A HREF="#BETA_3D_NEW">[Previous Routine]</A>
<A HREF="#GET_2DT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	energy_to_ebin(dat,en)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
	en:	real,fltarr,	real or float array of energy values
KEYWORD:
	BIN	int,intarr	optional, angle bins corresponding to &quot;en&quot;
				used when energies depend upon angle bin
PURPOSE:
	Returns the energy bin numbers in &quot;dat.energy&quot; nearest to &quot;en&quot;

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-4-22		J.McFadden
</PRE><P>
<STRONG>(See <A href="functions/energy_to_ebin.pro">themis/spacecraft/particles/ESA/packet/functions/energy_to_ebin.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_2DT">
<H2>GET_2DT</H2></A>
<A HREF="#ENERGY_TO_EBIN">[Previous Routine]</A>
<A HREF="#GET_EN_SPEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROGRAM:	get_2dt,funct,get_dat
INPUT:	
	funct:	function,	function that operates on structures generated 
					by get_eesa_surv, get_eesa_burst, etc.
				funct   = 'n_2d','j_2d','v_2d','p_2d','t_2d',
					  'vth_2d','ec_2d', or 'je_2d'
	get_dat, 	a string that defines the 'routine' that returns a 2D or 3D data structure
			if 'probe' keyword set, assumes routine = get_dat
			if 'probe' keyword is not set, assumes routine = 'get_'+ get_dat
				unless get_dat already includes 'get_', in which case routine = get_dat
			for example, get_dat='thc_peir' then routine = 'get_thc_peir'
			for example, get_dat='thm_sst_pser' then routine = 'thm_sst_pser'

KEYWORDS
	T1:	real or dbl	start time, seconds since 1970
	T2:	real or dbl	end time, seconds since 1970		
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
	GAP_TIME: 		time gap big enough to signify a data gap 
				(def 200 sec, 8 sec for FAST)
	NO_DATA: 	returns 1 if no_data else returns 0
	NAME:  		New name of the Data Quantity
				Default: funct+'_'+get_dat
	BKG:  		A 3d data structure containing the background counts.
	FLOOR:  	Sets the minimum value of any data point to sqrt(bkg).
	MISSING: 	value for bad data.
					0,1=exclude,include
	CALIB:		Calib keyword passed on to get_dat -- no longer used
	PROBE:		probe keyword passed on to get_dat -- used by themis sst routines

PURPOSE:
	To generate time series data for &quot;tplot.pro&quot; 
NOTES:	
	Program names time series data to funct+&quot;_&quot;+get_dat if NAME keyword not set
		See 'tplot_names.pro'.

CREATED BY:
	J.McFadden
LAST MODIFICATION:  97/03/04
MOD HISTORY:	
		97/03/04	T1,T2 keywords added
		08/07/10	bkg keyword changed to work for Themis ion ESA
		08/12/31	bkg keyword changed to work for Themis electron sst
		08/12/31	added probe keyword for themis sst calls
		09/01/05	changed loop to use index to allow for dat.valid=0 data in stored data
		09/01/05	calib keyword no longer passed to routine

NOTES:	  
	Current version only works for FAST
</PRE><P>
<STRONG>(See <A href="functions/get_2dt.pro">themis/spacecraft/particles/ESA/packet/functions/get_2dt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_EN_SPEC">
<H2>GET_EN_SPEC</H2></A>
<A HREF="#GET_2DT">[Previous Routine]</A>
<A HREF="#JE_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	get_en_spec
PURPOSE:	
	Generates energy-time spectrogram data structures for tplot
INPUT:		
	get_dat, 	a string that defines the 'routine' that returns a 2D or 3D data structure
			if 'probe' keyword set, assumes routine = get_dat
			if 'probe' keyword is not set, assumes routine = 'get_'+ get_dat
				unless get_dat already includes 'get_', in which case routine = get_dat
			for example, get_dat='thc_peir' then routine = 'get_thc_peir'
			for example, get_dat='thm_sst_pser' then routine = 'thm_sst_pser'

KEYWORDS:
	T1:		start time, seconds since 1970
	T2:		end time, seconds since 1970		
	ANGLE:		fltarr(2),fltarr(4)	angle range to sum over
	ARANGE:		intarr(2)		bin range to sum over
	BINS:		bytarr(dat.nbins)	bins to sum over
	gap_time: 	time gap big enough to signify a data gap 
			(default 200 sec, 8 sec for FAST)
	NO_DATA: 	returns 1 if no_data else returns 0
	UNITS:		convert to these units if included
	NAME:  		New name of the Data Quantity, default = get_dat + '_en_spec'
	BKG:  		A 3d data structure containing the background counts 
			If bkg=1, it will run themis background subtraction routine
	FLOOR:  	Sets the minimum value of any data point to sqrt(bkg).
	MISSING: 	value for bad data.
	RETRACE: 	Set to number of retrace energy steps to be eliminated starting at energy step 0
	CALIB:		Calib keyword passed on to get_dat -- no longer used
	PROBE:		probe keyword passed on to get_dat -- used by themis sst routines



CREATED BY:	J.McFadden
VERSION:	1
LAST MODIFICATION:  97/03/04
MOD HISTORY:
		97/03/04	T1,T2 keywords added
		97/05/22	CALIB keyword added
		08/07/10	bkg keyword changed to work for Themis ion ESA
		08/07/10	averaging routine changed to weight different angle bins by dat.gf 
		08/12/31	bkg keyword changed to work for Themis electron sst
		08/12/31	probe keyword added for themis sst routines
		09/01/05	changed loop to use index to allow for dat.valid=0 data in stored data
		09/01/05	calib keyword no longer passed to routine


NOTES:	  
	Current version only works for FAST and THEMIS
</PRE><P>
<STRONG>(See <A href="functions/get_en_spec.pro">themis/spacecraft/particles/ESA/packet/functions/get_en_spec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="JE_3D_NEW">
<H2>JE_3D_NEW</H2></A>
<A HREF="#GET_EN_SPEC">[Previous Routine]</A>
<A HREF="#JE_PAR_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	je_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	3d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the energy flux, [JEx,JEy,JEz], 1/(cm^2-s) 
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	02-9-13
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/je_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/je_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="JE_PAR_3D_NEW">
<H2>JE_PAR_3D_NEW</H2></A>
<A HREF="#JE_3D_NEW">[Previous Routine]</A>
<A HREF="#J_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	je_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	3d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the energy flux, [JEx,JEy,JEz], 1/(cm^2-s) 
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	02-9-13
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/je_par_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/je_par_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="J_3D_NEW">
<H2>J_3D_NEW</H2></A>
<A HREF="#JE_PAR_3D_NEW">[Previous Routine]</A>
<A HREF="#N_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	j_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the flux, [Jx,Jy,Jz], 1/(cm^2-s) 
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	00-2-24
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/j_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/j_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="N_3D_NEW">
<H2>N_3D_NEW</H2></A>
<A HREF="#J_3D_NEW">[Previous Routine]</A>
<A HREF="#P_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	n_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the density, n, 1/cm^3, corrects for spacecraft potential if dat.sc_pot exists
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to 
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	00-2-24	
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/n_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/n_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="P_3D_NEW">
<H2>P_3D_NEW</H2></A>
<A HREF="#N_3D_NEW">[Previous Routine]</A>
<A HREF="#T_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	p_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the pressure tensor, [Pxx,Pyy,Pzz,Pxy,Pxz,Pyz], eV/cm^3 
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	00-2-24	
LAST MODIFICATION:
	J.McFadden	05-2-8		Fixed diagonalization
	J.McFadden	06-2-23		changed the s/c pot calculation to the same as n_2d_new.pro
</PRE><P>
<STRONG>(See <A href="functions/p_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/p_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="T_3D_NEW">
<H2>T_3D_NEW</H2></A>
<A HREF="#P_3D_NEW">[Previous Routine]</A>
<A HREF="#VPAR_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	t_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	3d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the temperature, [Tx,Ty,Tz,Tavg], eV 
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	00-2-24
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/t_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/t_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="VPAR_3D_NEW">
<H2>VPAR_3D_NEW</H2></A>
<A HREF="#T_3D_NEW">[Previous Routine]</A>
<A HREF="#VPERP_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	vpar_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	3d data structure 
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns Vpar, km/s, corrects for spacecraft potential if dat.sc_pot exists
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to 
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	07-6-05	
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/vpar_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/vpar_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="VPERP_3D_NEW">
<H2>VPERP_3D_NEW</H2></A>
<A HREF="#VPAR_3D_NEW">[Previous Routine]</A>
<A HREF="#VXB_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	vperp_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	3d data structure 
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns Vperp, km/s, corrects for spacecraft potential if dat.sc_pot exists
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to 
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	07-6-05	
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/vperp_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/vperp_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="VXB_3D_NEW">
<H2>VXB_3D_NEW</H2></A>
<A HREF="#VPERP_3D_NEW">[Previous Routine]</A>
<A HREF="#V_3D_NEW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	vxb_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	3d data structure 
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns VxB, mV/m, corrects for spacecraft potential if dat.sc_pot exists
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to 
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	07-4-29	
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/vxb_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/vxb_3d_new.pro</A>)</STRONG><P>
<HR>
 
<A NAME="V_3D_NEW">
<H2>V_3D_NEW</H2></A>
<A HREF="#VXB_3D_NEW">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	v_3d_new(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2,2),	optional, angle range for integration
				theta min,max (0,0),(1,0) -90&lt;theta&lt;90 
				phi   min,max (0,1),(1,1)   0&lt;phi&lt;360 
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the velocity, [Vx,Vy,Vz], km/s 
NOTES:	
	Function normally called by &quot;get_3dt&quot; or &quot;get_2dt&quot; to
	generate time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	02-8-28	
LAST MODIFICATION:
</PRE><P>
<STRONG>(See <A href="functions/v_3d_new.pro">themis/spacecraft/particles/ESA/packet/functions/v_3d_new.pro</A>)</STRONG><P>
<HR>
 
